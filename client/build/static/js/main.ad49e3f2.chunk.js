(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{48:function(e,t,c){},74:function(e,t,c){"use strict";c.r(t);var n=c(0),r=c(1),s=c(17),i=c.n(s),o=(c(48),c(13)),a=c.n(o),l=c(15),u=c(2),j=c(8),d=c(7),b=function(){return Object(n.jsx)("div",{className:"left-nav-container",children:Object(n.jsx)("div",{className:"icons",children:Object(n.jsxs)("div",{className:"icons-bis",children:[Object(n.jsx)(j.b,{exact:!0,to:"/",activeClassName:"active-left-nav",children:Object(n.jsx)("img",{src:"./img/icons/home.svg",alt:"home"})}),Object(n.jsx)("br",{}),Object(n.jsx)(j.b,{exact:!0,to:"/trending",activeClassName:"active-left-nav",children:Object(n.jsx)("img",{src:"./img/icons/rocket.svg",alt:"home"})}),Object(n.jsx)("br",{}),Object(n.jsx)(j.b,{exact:!0,to:"/profil",activeClassName:"active-left-nav",children:Object(n.jsx)("img",{src:"./img/icons/user.svg",alt:"home"})})]})})})},p=c(3),O=c(5),h=c.n(O),m="GET_POSTS",f="GET_ALL_POST",x="LIKE_POST",g="UNLIKE_POST",v="UPDATE_POST",w="DELETE_POST",y="EDIT_COMMENT",N="DELETE_COMMENT",S="GET_TRENDS",_="GET_POST_ERRORS",k=function(e){return function(t){return h()({method:"get",url:"".concat("http://localhost:5000/","api/post")}).then((function(c){var n=c.data.slice(0,e);t({type:m,payload:n}),t({type:f,payload:c.data})})).catch((function(e){return console.log({err:e})}))}},C=function(e){return function(t){return h()({method:"post",url:"".concat("http://localhost:5000/","api/post"),data:e}).then((function(e){e.data.errors?t({type:_,payload:e.data.errors}):t({type:_,payload:""})})).catch((function(e){return console.log({err:e})}))}},E=function(e){var t=Date.parse(e);return new Date(t).toLocaleDateString("fr-FR",{hour:"2-digit",minute:"2-digit",second:"2-digit",weekday:"long",year:"numeric",month:"short",day:"numeric"}).toString()},I=function(e){return new Date(e).toLocaleDateString("fr-FR",{hour:"2-digit",minute:"2-digit",second:"2-digit",weekday:"long",year:"numeric",month:"short",day:"numeric"}).toString()},T=function(e){return void 0===e||null===e||"object"===typeof e&&0===Object.keys(e).length||"string"===typeof e&&0===e.trim().length},R="GET_USER",F="UPLOAD_PICTURE",L="UPDATE_BIO",D="FOLLOW_USER",P="UNFOLLOW_USER",M="GET_USER_ERRORS",U=function(e){var t=e.idToFollow,c=e.type,s=Object(p.c)((function(e){return e.userReducer})),i=Object(r.useState)(!1),o=Object(u.a)(i,2),a=o[0],l=o[1],j=Object(p.b)();return Object(r.useEffect)((function(){T(s.following)||(s.following.includes(t)?l(!0):l(!1))}),[s,t]),Object(n.jsxs)(n.Fragment,{children:[a&&!T(s)&&Object(n.jsxs)("span",{onClick:function(){var e,c;j((e=s._id,c=t,function(t){return h()({method:"patch",url:"".concat("http://localhost:5000/","api/user/unfollow/").concat(e),data:{idToUnfollow:c}}).then((function(){t({type:P,payload:{idToUnfollow:c}})})).catch((function(e){return console.log({err:e})}))})),l(!1)},children:["suggestion"===c&&Object(n.jsx)("button",{className:"unfollow-btn",children:"Abonn\xe9"}),"card"===c&&Object(n.jsx)("img",{src:"./img/icons/checked.svg",alt:"checked"})]}),!a&&!T(s)&&Object(n.jsxs)("span",{onClick:function(){j(function(e,t){return function(c){return h()({method:"patch",url:"".concat("http://localhost:5000/","api/user/follow/").concat(e),data:{idToFollow:t}}).then((function(){c({type:D,payload:{idToFollow:t}})})).catch((function(e){return console.log({err:e})}))}}(s._id,t)),l(!0)},children:["suggestion"===c&&Object(n.jsx)("button",{className:"follow-btn",children:"Suivre"}),"card"===c&&Object(n.jsx)("img",{src:"./img/icons/check.svg",alt:"check"})]})]})},A=Object(r.createContext)(null),H=c(39),V=(c(73),function(e){var t=e.post,c=Object(r.useState)(!1),s=Object(u.a)(c,2),i=s[0],o=s[1],a=Object(r.useContext)(A),l=Object(p.b)();Object(r.useEffect)((function(){t.likers.includes(a)?o(!0):o(!1)}),[a,i,t.likers]);return Object(n.jsxs)("div",{className:"like-container",children:[null===a&&Object(n.jsx)(H.a,{trigger:Object(n.jsx)("img",{src:"./img/icons/heart.svg",alt:"like"}),position:["bottom center","bottom right","bottom left"],closeDocumentClick:!0,children:Object(n.jsx)("div",{style:{textAlign:"center"},children:"Connectez-vous pour liker un post !"})}),a&&!i&&Object(n.jsx)("img",{onClick:function(){var e,c;l((e=t._id,c=a,function(t){return h()({method:"patch",url:"".concat("http://localhost:5000/","api/post/like-post/").concat(e),data:{id:c}}).then((function(){t({type:x,payload:{postId:e,userId:c}})})).catch((function(e){return console.log({err:e})}))})),o(!0)},src:"./img/icons/heart.svg",alt:"like"}),a&&i&&Object(n.jsx)("img",{onClick:function(){var e,c;l((e=t._id,c=a,function(t){return h()({method:"patch",url:"".concat("http://localhost:5000/","api/post/unlike-post/").concat(e),data:{id:c}}).then((function(){t({type:g,payload:{postId:e,userId:c}})})).catch((function(e){return console.log({err:e})}))})),o(!1)},src:"./img/icons/heart-filled.svg",alt:"like"}),Object(n.jsx)("span",{children:t.likers&&t.likers.length})]})}),z=function(e){var t=e.id,c=Object(p.b)(),r=function(){var e;c((e=t,function(t){return h()({method:"delete",url:"".concat("http://localhost:5000/","api/post/").concat(e)}).then((function(){t({type:w,payload:{postId:e}})})).catch((function(e){return console.log({err:e})}))}))};return Object(n.jsx)("div",{onClick:function(){window.confirm("Voulez-vous supprimer cet article ?")&&r()},children:Object(n.jsx)("img",{src:"./img/icons/trash.svg",alt:"trash"})})},B=function(e){var t=e.comment,c=e.postId,s=Object(r.useState)(!1),i=Object(u.a)(s,2),o=i[0],a=i[1],l=Object(r.useState)(!1),j=Object(u.a)(l,2),d=j[0],b=j[1],O=Object(r.useState)(""),m=Object(u.a)(O,2),f=m[0],x=m[1],g=Object(r.useContext)(A),v=Object(p.b)(),w=function(){v(function(e,t){return function(c){return h()({method:"patch",url:"".concat("http://localhost:5000/","api/post/delete-comment-post/").concat(e),data:{commentId:t}}).then((function(){c({type:N,payload:{postId:e,commentId:t}})})).catch((function(e){return console.log({err:e})}))}}(c,t._id))};return Object(r.useEffect)((function(){g===t.commenterId&&a(!0)}),[g,t.commenterId]),Object(n.jsxs)("div",{className:"edit-comment",children:[o&&!d&&Object(n.jsx)("span",{onClick:function(){return b(!d)},children:Object(n.jsx)("img",{src:"./img/icons/edit.svg",alt:"edit"})}),o&&d&&Object(n.jsxs)("form",{className:"edit-comment-form",onSubmit:function(e){e.preventDefault(),f&&(v(function(e,t,c){return function(n){return h()({method:"patch",url:"".concat("http://localhost:5000/","api/post/edit-comment-post/").concat(e),data:{commentId:t,text:c}}).then((function(){n({type:y,payload:{postId:e,commentId:t,text:c}})})).catch((function(e){return console.log({err:e})}))}}(c,t._id,f)),x(""),b(!1))},children:[Object(n.jsx)("label",{htmlFor:"text",onClick:function(){return b(!d)},children:"Editer"}),Object(n.jsx)("br",{}),Object(n.jsx)("input",{type:"text",name:"text",onChange:function(e){return x(e.target.value)},defaultValue:t.text}),Object(n.jsx)("br",{}),Object(n.jsxs)("div",{className:"btn",children:[Object(n.jsx)("span",{onClick:function(){window.confirm("Voulez-vous supprimer ce commentaire ?")&&w()},children:Object(n.jsx)("img",{src:"./img/icons/trash.svg",alt:"trash"})}),Object(n.jsx)("input",{type:"submit",value:"Valider les modifications"})]})]})]})},q=function(e){var t=e.post,c=Object(r.useState)(""),s=Object(u.a)(c,2),i=s[0],o=s[1],a=Object(p.c)((function(e){return e.usersReducer})),l=Object(p.c)((function(e){return e.userReducer})),j=Object(p.b)();return Object(n.jsxs)("div",{className:"comments-container",children:[t.comments.map((function(e){return Object(n.jsxs)("div",{className:e.commenterId===l._id?"comment-container client":"comment-container",children:[Object(n.jsx)("div",{className:"left-part",children:!T(a[0])&&a.map((function(t){return t._id===e.commenterId?Object(n.jsx)("img",{src:t.picture,alt:e.commenterId},e.commenterId):null}))}),Object(n.jsxs)("div",{className:"right-part",children:[Object(n.jsxs)("div",{className:"comment-header",children:[Object(n.jsxs)("div",{className:"pseudo",children:[Object(n.jsx)("h3",{children:e.commenterPseudo}),e.commenterId!==l._id&&Object(n.jsx)(U,{idToFollow:e.commenterId,type:"card"})]}),Object(n.jsx)("span",{children:I(e.timestamp)})]}),Object(n.jsx)("p",{children:e.text}),Object(n.jsx)(B,{comment:e,postId:t._id})]})]},e._id)})),l._id&&Object(n.jsxs)("form",{onSubmit:function(e){e.preventDefault(),i&&j(function(e,t,c,n){return function(r){return h()({method:"patch",url:"".concat("http://localhost:5000/","api/post/comment-post/").concat(e),data:{commenterId:t,text:c,commenterPseudo:n}}).then((function(){r({type:"ADD_COMMENT",payload:{postId:e}})})).catch((function(e){return console.log({err:e})}))}}(t._id,l._id,i,l.pseudo)).then((function(){return j(k())})).then((function(){return o("")})).catch((function(e){return console.log({err:e})}))},className:"comment-form",children:[Object(n.jsx)("input",{type:"text",name:"text",onChange:function(e){return o(e.target.value)},value:i,placeholder:"Laisser un commentaire"}),Object(n.jsx)("br",{}),Object(n.jsx)("input",{type:"submit",value:"Envoyer"})]})]})},G=function(e){var t=e.post,c=Object(r.useState)(!0),s=Object(u.a)(c,2),i=s[0],o=s[1],a=Object(r.useState)(!1),l=Object(u.a)(a,2),j=l[0],d=l[1],b=Object(r.useState)(null),O=Object(u.a)(b,2),m=O[0],f=O[1],x=Object(r.useState)(!1),g=Object(u.a)(x,2),w=g[0],y=g[1],N=Object(p.c)((function(e){return e.usersReducer})),S=Object(p.c)((function(e){return e.userReducer})),_=Object(p.b)();return Object(r.useEffect)((function(){T(N[0])||o(!1)}),[N]),Object(n.jsx)("li",{className:"card-container",children:i?Object(n.jsx)("i",{className:"fas fa-spinner fa-spin"}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("div",{className:"card-left",children:!T(N[0])&&N.map((function(e){return e._id===t.posterId?Object(n.jsx)("img",{src:e.picture,alt:e.picture},e._id):null}))}),Object(n.jsxs)("div",{className:"card-right",children:[Object(n.jsxs)("div",{className:"card-header",children:[Object(n.jsx)("div",{className:"pseudo",children:!T(N[0])&&N.map((function(e){return e._id===t.posterId?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("h3",{children:e.pseudo},e._id),t.posterId!==S._id&&Object(n.jsx)(U,{idToFollow:t.posterId,type:"card"})]}):null}))}),Object(n.jsx)("span",{children:E(t.createdAt)})]}),!j&&Object(n.jsx)("p",{children:t.message}),j&&Object(n.jsxs)("div",{className:"update-post",children:[Object(n.jsx)("textarea",{defaultValue:t.message,onChange:function(e){return f(e.target.value)}}),Object(n.jsx)("div",{className:"button-container",children:Object(n.jsx)("button",{className:"btn",onClick:function(){var e,c;m&&_((e=t._id,c=m,function(t){return h()({method:"put",url:"".concat("http://localhost:5000/","api/post/").concat(e),data:{message:c}}).then((function(){t({type:v,payload:{message:c,postId:e}})})).catch((function(e){return console.log({err:e})}))})),d(!1)},children:"Valider modifications"})})]}),t.picture&&Object(n.jsx)("img",{src:t.picture,alt:t.picture,className:"card-pic"}),t.video&&Object(n.jsx)("iframe",{width:"500",height:"300",src:t.video,frameBorder:"0",title:t._id,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),S._id===t.posterId&&Object(n.jsxs)("div",{className:"button-container",children:[Object(n.jsx)("div",{onClick:function(){return d(!j)},children:Object(n.jsx)("img",{src:"./img/icons/edit.svg",alt:"edit"})}),Object(n.jsx)(z,{id:t._id})]}),Object(n.jsxs)("div",{className:"card-footer",children:[Object(n.jsx)(V,{post:t}),Object(n.jsxs)("div",{className:"comment-icon",children:[Object(n.jsx)("img",{onClick:function(){return y(!w)},src:"./img/icons/message1.svg",alt:"comment"}),t.comments&&Object(n.jsx)("span",{children:t.comments.length})]})]}),w&&Object(n.jsx)(q,{post:t})]})]})})},J=function(){var e=Object(r.useState)(!0),t=Object(u.a)(e,2),c=t[0],s=t[1],i=Object(r.useState)(5),o=Object(u.a)(i,2),a=o[0],l=o[1],j=Object(p.b)(),d=Object(p.c)((function(e){return e.postReducer})),b=function(){window.innerHeight+document.documentElement.scrollTop+1>document.scrollingElement.scrollHeight&&s(!0)};return Object(r.useEffect)((function(){return c&&(j(k(a)),s(!1),l(a+5)),window.addEventListener("scroll",b),function(){return window.removeEventListener}}),[j,c,a]),Object(n.jsx)("div",{className:"thread-container",children:Object(n.jsx)("ul",{children:!T(d[0])&&d.map((function(e){return Object(n.jsx)(G,{post:e},e._id)}))})})},W=function(){var e=Object(r.useState)(!0),t=Object(u.a)(e,2),c=t[0],s=t[1],i=Object(r.useState)(""),o=Object(u.a)(i,2),d=o[0],b=o[1],O=Object(r.useState)(null),h=Object(u.a)(O,2),m=h[0],f=h[1],x=Object(r.useState)(""),g=Object(u.a)(x,2),v=g[0],w=g[1],y=Object(r.useState)(""),N=Object(u.a)(y,2),S=N[0],_=N[1],E=Object(p.c)((function(e){return e.userReducer})),R=Object(p.c)((function(e){return e.errorReducer.postError})),F=Object(p.b)(),L=function(){var e=Object(l.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(d||m||v)){e.next=12;break}return(t=new FormData).append("posterId",E._id),t.append("message",d),S&&t.append("file",S),t.append("video",v),e.next=8,F(C(t));case 8:F(k()),D(),e.next=13;break;case 12:alert("Veuillez entrer un message");case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(){b(""),f(""),w(""),_("")};return Object(r.useEffect)((function(){T(E)||s(!1),function(){for(var e=d.split(" "),t=0;t<e.length;t++)if(e[t].includes("https://www.yout")||e[t].includes("https://yout")){var c=e[t].replace("watch?v=","embed/");w(c.split("&")[0]),e.splice(t,1),b(e.join(" ")),f(null)}}()}),[E,d,v]),Object(n.jsx)("div",{className:"post-container",children:c?Object(n.jsx)("i",{className:"fas fa-spinner fa-pulse"}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("div",{className:"data",children:[Object(n.jsxs)("p",{children:[Object(n.jsx)("span",{children:E.following?E.following.length:0}),"\xa0Abonnement",E.following&&E.following.length>1?"s":null]}),Object(n.jsxs)("p",{children:[Object(n.jsx)("span",{children:E.followers?E.followers.length:0}),"\xa0Abonn\xe9",E.followers&&E.followers.length>1?"s":null]})]}),Object(n.jsx)(j.b,{exact:!0,to:"/profil",children:Object(n.jsx)("div",{className:"user-info",children:Object(n.jsx)("img",{src:E.picture,alt:"profil"})})}),Object(n.jsxs)("div",{className:"post-form",children:[Object(n.jsx)("textarea",{name:"message",id:"message",placeholder:"Quoi de neuf ?",value:d,onChange:function(e){return b(e.target.value)}}),d||m||v.length>10?Object(n.jsxs)("li",{className:"card-container",children:[Object(n.jsx)("div",{className:"card-left",children:Object(n.jsx)("img",{src:E.picture,alt:"pic"})}),Object(n.jsxs)("div",{className:"card-right",children:[Object(n.jsxs)("div",{className:"card-header",children:[Object(n.jsx)("div",{className:"pseudo",children:Object(n.jsx)("h3",{children:E.pseudo})}),Object(n.jsx)("span",{children:I(Date.now())})]}),Object(n.jsxs)("div",{className:"content",children:[Object(n.jsx)("p",{children:d}),m&&Object(n.jsx)("img",{src:m,alt:"post-img"}),v&&Object(n.jsx)("iframe",{title:v,src:v,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypte-media; gyroscope; picture-in-picture",allowFullScreen:!0})]})]})]}):null,Object(n.jsxs)("div",{className:"footer-form",children:[Object(n.jsxs)("div",{className:"icon",children:[T(v)&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("img",{src:"./img/icons/picture.svg",alt:"pic"}),Object(n.jsx)("input",{type:"file",id:"file-upload",name:"file",accept:".jpg, .jpeg, .png",onChange:function(e){f(URL.createObjectURL(e.target.files[0])),_(e.target.files[0]),w("")}})]}),v&&Object(n.jsx)("button",{onClick:function(){return w("")},children:"Supprimer video"})]}),!T(R.format)&&Object(n.jsx)("p",{children:R.format}),!T(R.maxSize)&&Object(n.jsx)("p",{children:R.maxSize}),Object(n.jsxs)("div",{className:"btn-send",children:[d||m||v.length>5?Object(n.jsx)("button",{className:"cancel",onClick:D,children:"Annuler message"}):null,Object(n.jsx)("button",{className:"send",onClick:L,children:"Envoyer"})]})]})]})]})})},K=function(){var e=Object(r.useState)(""),t=Object(u.a)(e,2),c=t[0],s=t[1],i=Object(r.useState)(""),o=Object(u.a)(i,2),a=o[0],l=o[1];return Object(n.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t=document.querySelector(".email.error"),n=document.querySelector(".password.error");h()({method:"post",url:"".concat("http://localhost:5000/","api/user/login"),withCredentials:!0,data:{email:c,password:a}}).then((function(e){e.data.errors?(t.innerHTML=e.data.errors.email,n.innerHTML=e.data.errors.password):window.location="/"})).catch((function(e){return console.log(e)}))},id:"sign-up-form",children:[Object(n.jsx)("label",{htmlFor:"email",children:"Email"}),Object(n.jsx)("br",{}),Object(n.jsx)("input",{onChange:function(e){return s(e.target.value)},type:"text",name:"email",id:"email",value:c}),Object(n.jsx)("div",{className:"email error"}),Object(n.jsx)("br",{}),Object(n.jsx)("label",{htmlFor:"password",children:"Mot de passe"}),Object(n.jsx)("br",{}),Object(n.jsx)("input",{onChange:function(e){return l(e.target.value)},type:"password",name:"password",id:"password",value:a}),Object(n.jsx)("div",{className:"password error"}),Object(n.jsx)("br",{}),Object(n.jsx)("input",{type:"submit",value:"Se connecter"})]})},Q=function(){var e=Object(r.useState)(!1),t=Object(u.a)(e,2),c=t[0],s=t[1],i=Object(r.useState)(""),o=Object(u.a)(i,2),j=o[0],d=o[1],b=Object(r.useState)(""),p=Object(u.a)(b,2),O=p[0],m=p[1],f=Object(r.useState)(""),x=Object(u.a)(f,2),g=x[0],v=x[1],w=Object(r.useState)(""),y=Object(u.a)(w,2),N=y[0],S=y[1],_=function(){var e=Object(l.a)(a.a.mark((function e(t){var c,n,r,i,o,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),c=document.getElementById("terms"),n=document.querySelector(".pseudo.error"),r=document.querySelector(".email.error"),i=document.querySelector(".password.error"),o=document.querySelector(".password-confirm.error"),l=document.querySelector(".terms.error"),o.innerHTML="",l.innerHTML="",g===N&&c.checked){e.next=14;break}g!==N&&(o.innerHTML="Les mots de passe ne correspondent pas"),c.checked||(l.innerHTML="Veuillez valider les conditions g\xe9n\xe9rales"),e.next=16;break;case 14:return e.next=16,h()({method:"post",url:"".concat("http://localhost:5000/","api/user/register"),data:{pseudo:j,email:O,password:g}}).then((function(e){e.data.errors?(n.innerHTML=e.data.errors.pseudo,r.innerHTML=e.data.errors.email,i.innerHTML=e.data.errors.password):s(!0)})).catch((function(e){return console.log(e)}));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsx)(n.Fragment,{children:c?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(K,{}),Object(n.jsx)("span",{}),Object(n.jsx)("h4",{className:"success",children:"Enregistrement r\xe9ussi, veuillez-vous connecter"})]}):Object(n.jsxs)("form",{onSubmit:_,id:"sign-up-form",children:[Object(n.jsx)("label",{htmlFor:"pseudo",children:"Pseudo"}),Object(n.jsx)("br",{}),Object(n.jsx)("input",{onChange:function(e){return d(e.target.value)},type:"text",name:"pseudo",id:"pseudo",value:j}),Object(n.jsx)("div",{className:"pseudo error"}),Object(n.jsx)("br",{}),Object(n.jsx)("label",{htmlFor:"email",children:"Email"}),Object(n.jsx)("br",{}),Object(n.jsx)("input",{onChange:function(e){return m(e.target.value)},type:"text",name:"email",id:"email",value:O}),Object(n.jsx)("div",{className:"email error"}),Object(n.jsx)("br",{}),Object(n.jsx)("label",{htmlFor:"password",children:"Mot de passe"}),Object(n.jsx)("br",{}),Object(n.jsx)("input",{onChange:function(e){return v(e.target.value)},type:"password",name:"password",id:"password",value:g}),Object(n.jsx)("div",{className:"password error"}),Object(n.jsx)("br",{}),Object(n.jsx)("label",{htmlFor:"password-conf",children:"Confirmer mot de passe"}),Object(n.jsx)("br",{}),Object(n.jsx)("input",{onChange:function(e){return S(e.target.value)},type:"password",name:"password-conf",id:"password-conf",value:N}),Object(n.jsx)("div",{className:"password-confirm error"}),Object(n.jsx)("br",{}),Object(n.jsx)("input",{type:"checkbox",id:"terms"}),Object(n.jsxs)("label",{htmlFor:"terms",children:["J'accepte les ",Object(n.jsx)("a",{href:"/",target:"_blank",rel:"noopener noreferrer",children:"conditions g\xe9n\xe9rales"})]}),Object(n.jsx)("div",{className:"terms error"}),Object(n.jsx)("br",{}),Object(n.jsx)("input",{type:"submit",value:"Valider inscription"})]})})},X=function(e){var t=e.signIn,c=e.signUp,s=Object(r.useState)(c),i=Object(u.a)(s,2),o=i[0],a=i[1],l=Object(r.useState)(t),j=Object(u.a)(l,2),d=j[0],b=j[1],p=function(e){"register"===e.target.id?(b(!1),a(!0)):"login"===e.target.id&&(b(!0),a(!1))};return Object(n.jsx)("div",{className:"connection-form",children:Object(n.jsxs)("div",{className:"form-container",children:[Object(n.jsxs)("ul",{children:[Object(n.jsx)("li",{onClick:p,id:"register",className:o?"active-btn":null,children:"S'inscrire"}),Object(n.jsx)("li",{onClick:p,id:"login",className:d?"active-btn":null,children:"Se connecter"})]}),o&&Object(n.jsx)(Q,{}),d&&Object(n.jsx)(K,{})]})})},Y=function(){var e=Object(p.c)((function(e){return e.allPostReducer})),t=Object(p.c)((function(e){return e.usersReducer})),c=Object(p.c)((function(e){return e.trendingReducer})),s=Object(p.b)();return Object(r.useEffect)((function(){if(!T(e[0])){var t=Object.keys(e).map((function(t){return e[t]})).sort((function(e,t){return t.likers.length-e.likers.length}));t.length=3,s(function(e){return function(t){t({type:S,payload:e})}}(t))}}),[e,s]),Object(n.jsxs)("div",{className:"trending-container",children:[Object(n.jsx)("h4",{children:"Trending"}),Object(n.jsx)(j.b,{exact:!0,to:"/trending",children:Object(n.jsx)("ul",{children:c.length&&c.map((function(e){return Object(n.jsxs)("li",{children:[Object(n.jsx)("div",{children:t[0]&&t.map((function(t){return t._id===e.posterId?Object(n.jsx)("img",{src:t.picture,alt:t.picture},t._id):null}))}),Object(n.jsxs)("div",{className:"trend-content",children:[Object(n.jsx)("p",{children:e.message}),Object(n.jsx)("span",{children:"Lire"})]})]},e._id)}))})})]})},Z=function(){var e=Object(r.useState)(!0),t=Object(u.a)(e,2),c=t[0],s=t[1],i=Object(r.useState)(!0),o=Object(u.a)(i,2),a=o[0],l=o[1],j=Object(r.useState)([]),d=Object(u.a)(j,2),b=d[0],O=d[1],h=Object(p.c)((function(e){return e.userReducer})),m=Object(p.c)((function(e){return e.usersReducer}));return Object(r.useEffect)((function(){!a||T(m[0])||T(h._id)||(!function(){var e=[];m.map((function(t){if(t._id!==h._id&&!t.followers.includes(h._id))return e.push(t._id)})),e.sort((function(){return.5-Math.random()})),window.innerHeight>780?e.length=6:window.innerHeight>720?e.length=4:window.innerHeight>615?e.length=2:window.innerHeight>540?e.length=1:e.length=0,O(e)}(),s(!1),l(!1))}),[h,m]),Object(n.jsxs)("div",{className:"get-friends-container",children:[Object(n.jsx)("h4",{children:"Suggestions"}),c?Object(n.jsx)("div",{className:"icon",children:Object(n.jsx)("i",{className:"fas fa-spinner fa-pulse"})}):Object(n.jsx)("ul",{children:b.map((function(e){for(var t=0;t<m.length;t++)if(e===m[t]._id)return Object(n.jsxs)("li",{className:"user-hint",children:[Object(n.jsx)("img",{src:m[t].picture,alt:m[t].picture}),Object(n.jsx)("p",{children:m[t].pseudo}),Object(n.jsx)(U,{idToFollow:m[t]._id,type:"suggestion"})]},e)}))})]})},$=function(){var e=Object(r.useContext)(A);return Object(n.jsxs)("div",{className:"home",children:[Object(n.jsx)(b,{}),Object(n.jsxs)("div",{className:"main",children:[Object(n.jsx)("div",{className:"home-header",children:e?Object(n.jsx)(W,{}):Object(n.jsx)(X,{signIn:!0,signUp:!1})}),Object(n.jsx)(J,{})]}),Object(n.jsx)("div",{className:"right-side",children:Object(n.jsx)("div",{className:"right-side-container",children:Object(n.jsxs)("div",{className:"wrapper",children:[Object(n.jsx)(Y,{}),e&&Object(n.jsx)(Z,{})]})})})]})},ee=function(){var e=Object(r.useState)(""),t=Object(u.a)(e,2),c=t[0],s=t[1],i=Object(p.b)(),o=Object(p.c)((function(e){return e.userReducer}));return Object(n.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t=new FormData;t.append("pseudo",o.pseudo),t.append("userId",o._id),t.append("file",c),i(function(e,t){return function(c){return h.a.post("".concat("http://localhost:5000/","api/user/upload"),e).then((function(e){if(!e.data.errors)return c({type:M,payload:""}),h.a.get("".concat("http://localhost:5000/","api/user/").concat(t)).then((function(e){c({type:F,payload:e.data.picture})})).catch((function(e){return console.log({err:e})}));c({type:M,payload:e.data.errors})})).catch((function(e){return console.log({err:e})}))}}(t,o._id))},className:"upload-pic",children:[Object(n.jsx)("label",{htmlFor:"file",children:"Changer d'image"}),Object(n.jsx)("input",{onChange:function(e){return s(e.target.files[0])},type:"file",id:"file",name:"file",accept:".jpeg, .jpg, .png"}),Object(n.jsx)("br",{}),Object(n.jsx)("input",{type:"submit",value:"Envoyer"})]})},te=function(){var e=Object(r.useState)(""),t=Object(u.a)(e,2),c=t[0],s=t[1],i=Object(r.useState)(!1),o=Object(u.a)(i,2),a=o[0],l=o[1],j=Object(p.c)((function(e){return e.userReducer})),d=Object(p.c)((function(e){return e.usersReducer})),O=Object(p.c)((function(e){return e.errorReducer.userError})),m=Object(p.b)(),f=Object(r.useState)(!1),x=Object(u.a)(f,2),g=x[0],v=x[1],w=Object(r.useState)(!1),y=Object(u.a)(w,2),N=y[0],S=y[1];return Object(n.jsxs)("div",{className:"profil-container",children:[Object(n.jsx)(b,{}),Object(n.jsxs)("h1",{children:["Profil de ",j.pseudo]}),Object(n.jsxs)("div",{className:"update-container",children:[Object(n.jsxs)("div",{className:"left-part",children:[Object(n.jsx)("h3",{children:"Photo de profil"}),Object(n.jsx)("img",{src:j.picture,alt:"user img"}),Object(n.jsx)(ee,{}),Object(n.jsx)("p",{children:O.maxSize}),Object(n.jsx)("p",{children:O.format})]}),Object(n.jsxs)("div",{className:"right-part",children:[Object(n.jsxs)("div",{className:"bio-update",children:[Object(n.jsx)("h3",{children:"Bio"}),!a&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("p",{onClick:function(){return l(!a)},children:j.bio}),Object(n.jsx)("button",{onClick:function(){return l(!a)},children:"Modifier bio"})]}),a&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("textarea",{onChange:function(e){return s(e.target.value)},defaultValue:j.bio}),Object(n.jsx)("button",{onClick:function(){m(function(e,t){return function(c){return h()({method:"put",url:"".concat("http://localhost:5000/","api/user/").concat(e),data:{bio:t}}).then((function(){c({type:L,payload:t})})).catch((function(e){return console.log({err:e})}))}}(j._id,c)),l(!1)},children:"Valider modifications"})]})]}),Object(n.jsxs)("h4",{children:["Membre depuis le : ",E(j.createdAt)]}),Object(n.jsxs)("h5",{onClick:function(){return v(!0)},children:["Abonnements : ",j.following?j.following.length:null]}),Object(n.jsxs)("h5",{onClick:function(){return S(!0)},children:["Abonn\xe9s : ",j.followers?j.followers.length:null]})]})]}),g&&Object(n.jsx)("div",{className:"popup-profil-container",children:Object(n.jsxs)("div",{className:"modal",children:[Object(n.jsx)("h3",{children:"Abonnements"}),Object(n.jsx)("span",{onClick:function(){return v(!1)},className:"cross",children:"\u2715"}),Object(n.jsx)("ul",{children:d.map((function(e){for(var t=0;t<j.following.length;t++)if(e._id===j.following[t])return Object(n.jsxs)("li",{children:[Object(n.jsx)("img",{src:e.picture,alt:"user-pic"}),Object(n.jsx)("h4",{children:e.pseudo}),Object(n.jsx)("div",{className:"follow-handler",children:Object(n.jsx)(U,{idToFollow:e._id,type:"suggestion"})})]},e._id)}))})]})}),N&&Object(n.jsx)("div",{className:"popup-profil-container",children:Object(n.jsxs)("div",{className:"modal",children:[Object(n.jsx)("h3",{children:"Abonn\xe9s"}),Object(n.jsx)("span",{onClick:function(){return S(!1)},className:"cross",children:"\u2715"}),Object(n.jsx)("ul",{children:d.map((function(e){for(var t=0;t<j.followers.length;t++)if(e._id===j.followers[t])return Object(n.jsxs)("li",{children:[Object(n.jsx)("img",{src:e.picture,alt:"user-pic"}),Object(n.jsx)("h4",{children:e.pseudo}),Object(n.jsx)("div",{className:"follow-handler",children:Object(n.jsx)(U,{idToFollow:e._id,type:"suggestion"})})]},e._id)}))})]})})]})},ce=function(){var e=Object(r.useContext)(A);return Object(n.jsx)("div",{className:"profil-page",children:e?Object(n.jsx)(te,{}):Object(n.jsxs)("div",{className:"log-container",children:[Object(n.jsx)(X,{signIn:!1,signUp:!0}),Object(n.jsx)("div",{className:"img-container",children:Object(n.jsx)("img",{src:"./img/log.svg",alt:"log"})})]})})},ne=function(){var e=Object(r.useContext)(A),t=Object(p.c)((function(e){return e.trendingReducer}));return Object(n.jsxs)("div",{className:"trending-page",children:[Object(n.jsx)(b,{}),Object(n.jsx)("div",{className:"main",children:Object(n.jsx)("ul",{children:!T(t[0])&&t.map((function(e){return Object(n.jsx)(G,{post:e},e._id)}))})}),Object(n.jsx)("div",{className:"right-side",children:Object(n.jsxs)("div",{className:"right-side-container",children:[Object(n.jsx)(Y,{}),e&&Object(n.jsx)(Z,{})]})})]})},re=c(40),se=c.n(re),ie=function(){var e=function(){var e=Object(l.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h()({method:"get",url:"".concat("http://localhost:5000/","api/user/logout"),withCredentials:!0}).then((function(){return e="jwt",void(void 0!==window&&se.a.remove(e,{expires:1}));var e})).catch((function(e){return console.log({err:e})}));case 2:window.location="/";case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.jsx)("li",{onClick:e,children:Object(n.jsx)("img",{src:"./img/icons/logout.svg",alt:"Logout"})})},oe=function(){var e=Object(r.useContext)(A),t=Object(p.c)((function(e){return e.userReducer}));return Object(n.jsx)("nav",{children:Object(n.jsxs)("div",{className:"nav-container",children:[Object(n.jsx)("div",{className:"logo",children:Object(n.jsx)(j.b,{exact:!0,to:"/",children:Object(n.jsxs)("div",{className:"logo",children:[Object(n.jsx)("img",{src:"./img/icon.png",alt:"logo"}),Object(n.jsx)("h3",{children:"Pineapple"})]})})}),e?Object(n.jsxs)("ul",{children:[Object(n.jsx)("li",{}),Object(n.jsx)("li",{className:"welcome",children:Object(n.jsx)(j.b,{exact:!0,to:"/profil",children:Object(n.jsxs)("h5",{children:["Bienvenue ",t.pseudo]})})}),Object(n.jsx)(ie,{})]}):Object(n.jsxs)("ul",{children:[Object(n.jsx)("li",{}),Object(n.jsx)("li",{children:Object(n.jsx)(j.b,{exact:!0,to:"/profil",children:Object(n.jsx)("img",{src:"./img/icons/login.svg",alt:"logo"})})})]})]})})},ae=function(){return Object(n.jsxs)(j.a,{children:[Object(n.jsx)(oe,{}),Object(n.jsxs)(d.d,{children:[Object(n.jsx)(d.b,{exact:!0,path:"/",component:$}),Object(n.jsx)(d.b,{exact:!0,path:"/profil",component:ce}),Object(n.jsx)(d.b,{exact:!0,path:"/trending",component:ne}),Object(n.jsx)(d.a,{to:"/"})]})]})},le=function(){var e=Object(r.useState)(null),t=Object(u.a)(e,2),c=t[0],s=t[1],i=Object(p.b)();return Object(r.useEffect)((function(){(function(){var e=Object(l.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h()({method:"get",url:"".concat("http://localhost:5000/","jwtid"),withCredentials:!0}).then((function(e){return s(e.data)})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().then((function(){return console.log({uid:c})})).catch((function(e){return console.log(e)})),c&&i(function(e){return function(t){return h.a.get("".concat("http://localhost:5000/","api/user/").concat(e)).then((function(e){t({type:R,payload:e.data})})).catch((function(e){return console.log({err:e})}))}}(c))}),[c,i]),Object(n.jsx)(A.Provider,{value:c,children:Object(n.jsx)(ae,{})})},ue=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,75)).then((function(t){var c=t.getCLS,n=t.getFID,r=t.getFCP,s=t.getLCP,i=t.getTTFB;c(e),n(e),r(e),s(e),i(e)}))},je=c(16),de=c(41),be=c(42),pe=c(23),Oe=c(6),he={};var me="GET_USERS",fe={};var xe={};var ge={postError:[],userError:[]};var ve={};var we={};var ye=Object(je.combineReducers)({userReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case R:return t.payload;case F:return Object(Oe.a)(Object(Oe.a)({},e),{},{picture:t.payload});case L:return Object(Oe.a)(Object(Oe.a)({},e),{},{bio:t.payload});case D:return Object(Oe.a)(Object(Oe.a)({},e),{},{following:[t.payload.idToFollow].concat(Object(pe.a)(e.following))});case P:return Object(Oe.a)(Object(Oe.a)({},e),{},{following:e.following.filter((function(e){return e!==t.payload.idToUnfollow}))});default:return e}},usersReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case me:return t.payload;default:return e}},postReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:return t.payload;case x:return e.map((function(e){return e._id===t.payload.postId?Object(Oe.a)(Object(Oe.a)({},e),{},{likers:[t.payload.userId].concat(Object(pe.a)(e.likers))}):e}));case g:return e.map((function(e){return e._id===t.payload.postId?Object(Oe.a)(Object(Oe.a)({},e),{},{likers:e.likers.filter((function(e){return e!==t.payload.userId}))}):e}));case v:return e.map((function(e){return e._id===t.payload.postId?Object(Oe.a)(Object(Oe.a)({},e),{},{message:t.payload.message}):e}));case w:return e.filter((function(e){return e._id!==t.payload.postId}));case y:return e.map((function(e){return e._id===t.payload.postId?Object(Oe.a)(Object(Oe.a)({},e),{},{comments:e.comments.map((function(e){return e._id===t.payload.commentId?Object(Oe.a)(Object(Oe.a)({},e),{},{text:t.payload.text}):e}))}):e}));case N:return e.map((function(e){return e._id===t.payload.postId?Object(Oe.a)(Object(Oe.a)({},e),{},{comments:e.comments.filter((function(e){return e._id!==t.payload.commentId}))}):e}));default:return e}},errorReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ge,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:return{postError:t.payload,userError:[]};case M:return{userError:t.payload,postError:[]};default:return e}},allPostReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return t.payload;default:return e}},trendingReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:return t.payload;default:return e}}}),Ne=Object(je.createStore)(ye,Object(de.composeWithDevTools)(Object(je.applyMiddleware)(be.a)));Ne.dispatch((function(e){return h.a.get("".concat("http://localhost:5000/","api/user")).then((function(t){e({type:me,payload:t.data})})).catch((function(e){return console.log({err:e})}))})),Ne.dispatch(k()),i.a.render(Object(n.jsx)(p.a,{store:Ne,children:Object(n.jsx)(le,{})}),document.getElementById("root")),ue()}},[[74,1,2]]]);
//# sourceMappingURL=main.ad49e3f2.chunk.js.map